<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DataConnector Class • teal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DataConnector Class">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">teal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data_connector_class.html">DataConnector Class</a>
    </li>
    <li>
      <a href="../articles/getting_started.html">Getting Started with Teal</a>
    </li>
    <li>
      <a href="../articles/teal_desiderata.html">Teal Desiderata</a>
    </li>
    <li>
      <a href="../articles/teal_design_and_implementation.html">Teal Design and Implementation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown">
	<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../../pre-release/index.html">pre-release</a></li>
   <li><a href="../../v0.10.0/index.html">v0.10.0</a></li>
   <li><a href="../../v0.9.5/index.html">v0.9.5</a></li>
   <li><a href="../../v0.9.4/index.html">v0.9.4</a></li>
   <li><a href="../../v0.9.3/index.html">v0.9.3</a></li>
   <li><a href="../../v0.9.2/index.html">v0.9.2</a></li>
   <li><a href="../../v0.9.1/index.html">v0.9.1</a></li>
   <li><a href="../../v0.9.0/index.html">v0.9.0</a></li>
   <li><a href="../../v0.8.5/index.html">v0.8.5</a></li>
   <li><a href="../../v0.8.4/index.html">v0.8.4</a></li>
   <li><a href="../../v0.8.3/index.html">v0.8.3</a></li>
   <li><a href="../../v0.8.2/index.html">v0.8.2</a></li>
   <li><a href="../../v0.7.0/index.html">v0.7.0</a></li>
   <li><a href="../../v0.6.0/index.html">v0.6.0</a></li>
   <li><a href="../../v0.0.5/index.html">v0.0.5</a></li>
   <li><a href="../../v0.0.4/index.html">v0.0.4</a></li>
   <li><a href="../../v0.0.3/index.html">v0.0.3</a></li>
   <li><a href="../../v0.0.2/index.html">v0.0.2</a></li>
   <li><a href="../../v0.0.1/index.html">v0.0.1</a></li>
</ul></li>
<!-- end_releases -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.roche.com/NEST/teal">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="data_connector_class_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="data_connector_class_files/dagre-0.0.1/dagre.min.js"></script><script src="data_connector_class_files/lodash-3.7.0/lodash.js"></script><script src="data_connector_class_files/nomnoml-0.2.0/nomnoml.js"></script><script src="data_connector_class_files/nomnoml-binding-0.1.0/nomnoml.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>DataConnector Class</h1>
                        <h4 class="author">Dawid Kałędkowski</h4>
            
            <h4 class="date">2020-04-17</h4>
      
      
      <div class="hidden name"><code>data_connector_class.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level3">
<h3 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h3>
<p>Data plays essential role in data analysis and <code>teal</code> provides several ways to include datasets into shiny application. Normally, one develops an application in way that data is available before app starts. This always involves passing <code>cdisc_data</code> object into <code><a href="../reference/init.html">teal::init()</a></code> function. This option is applicable if access to data is general, so that data can be accessed by server for multiple app users. In contrary to this, data can request some personal authorization (e.g. login and password) which causes <code>teal</code> application to initialize in two stages:</p>
<ol style="list-style-type: decimal">
<li>Login page</li>
<li>Loading data and start <code>teal</code> app</li>
</ol>
</div>
<div id="creating-an-app" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-an-app" class="anchor"></a>Creating an app</h3>
<p>From developer perspective, creating an app is limited to create so called <code>DataConnector</code> object which is passed to <code>teal::init(data = &lt;DataConnector&gt;, ...)</code>. Naming convention for <code>DataConnector</code> is similar to previously introduced in <code><a href="../reference/cdisc_data.html">cdisc_data()</a></code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>&lt;service&gt;_cdisc_data()</code> alternative to <code><a href="../reference/cdisc_data.html">cdisc_data()</a></code> defining list of datasets and code to check.</li>
<li>
<code>&lt;service&gt;_dataset()</code> alternative to <code><a href="../reference/cdisc_dataset.html">cdisc_dataset()</a></code> with additional service-specific arguments.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(teal)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: shiny</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; teal version 0.8.3</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rice_cdisc_data.html">rice_cdisc_data</a></span>(</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  <span class="kw"><a href="../reference/rice_dataset.html">rice_dataset</a></span>(<span class="dt">dataname =</span> <span class="st">"ADSL"</span>, <span class="dt">path =</span> <span class="st">"/path/to/ADSL"</span>),</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  <span class="kw"><a href="../reference/rice_dataset.html">rice_dataset</a></span>(<span class="dt">dataname =</span> <span class="st">"ADLB"</span>, <span class="dt">path =</span> <span class="st">"/path/to/ADLB"</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">)</a></code></pre></div>
<p>Created <code>data</code> object is passed to <code><a href="../reference/init.html">teal::init()</a></code> and after running <code>shinyApp</code> login page pops-up to authorize access to rice API.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">app &lt;-<span class="st"> </span><span class="kw"><a href="../reference/init.html">init</a></span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="dt">data =</span> data,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  <span class="dt">modules =</span> <span class="kw"><a href="../reference/root_modules.html">root_modules</a></span>(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="kw"><a href="../reference/module.html">module</a></span>(</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">      <span class="st">"ADSL AGE histogram"</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">      <span class="dt">server =</span> <span class="cf">function</span>(input, output, session, datasets) {</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">        output<span class="op">$</span>hist &lt;-<span class="st"> </span><span class="kw">renderPlot</span>({</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">          <span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(datasets<span class="op">$</span><span class="kw">get_data</span>(<span class="st">"ADSL"</span>, <span class="dt">filtered =</span> <span class="ot">TRUE</span>, <span class="dt">reactive =</span> <span class="ot">TRUE</span>)<span class="op">$</span>AGE)</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">        })</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">      },</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">      <span class="dt">ui =</span> <span class="cf">function</span>(id, ...) {ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id); <span class="kw">plotOutput</span>(<span class="kw">ns</span>(<span class="st">'hist'</span>))},</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">      <span class="dt">filters =</span> <span class="st">"ADSL"</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    )</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  ),</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="dt">filter =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  <span class="dt">header =</span> tags<span class="op">$</span><span class="kw">h1</span>(<span class="st">"Sample App"</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="kw">shinyApp</span>(app<span class="op">$</span>ui, app<span class="op">$</span>server)</a></code></pre></div>
<p>In the running application, <code>DataConnector</code> sets-up connection with <code>rice</code> and after successful authorization downloads datasets from provided <code>path</code>. Downloaded data are assigned to specified datanames in shiny environment. Since pre-processing is impossible for <code>DataConnector</code> before start of application, we provide to pre-process <code>ADSL</code> and <code>ADLB</code> after successful data loading from rice. To alter downloaded data one should pass modification commands to <code>code</code> argument. <code>code</code> should be a single character exactly the same as in <code><a href="../reference/cdisc_data.html">cdisc_data()</a></code>. <code>code</code> should refer to datanames defined by <code>DatasetConnector</code>(s). You don’t have to pass importing step as a <code>code</code> - it will be automatically extracted from <code>DataConnector</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">data_with_code &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rice_cdisc_data.html">rice_cdisc_data</a></span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw"><a href="../reference/rice_dataset.html">rice_dataset</a></span>(<span class="dt">dataname =</span> <span class="st">"ADSL"</span>, <span class="dt">path =</span> <span class="st">"/path/to/ADSL"</span>),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="kw"><a href="../reference/rice_dataset.html">rice_dataset</a></span>(<span class="dt">dataname =</span> <span class="st">"ADLB"</span>, <span class="dt">path =</span> <span class="st">"/path/to/ADLB"</span>),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">code =</span> <span class="st">"ADSL &lt;- ADSL %&gt;% mutate(new_variable = 1)</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">          ADLB &lt;- ADLB %&gt;% mutate(new_variable = 1)"</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">)</a></code></pre></div>
<p>Diagram below presents steps described above. In first frame created by <code>rice_cdisc_data</code> <code>DataConnector</code>, <code>ui</code> and <code>server</code> are passed to <code><a href="../reference/init.html">teal::init()</a></code> to run app described in second frame. <code><a href="https://rdrr.io/r/base/Arithmetic.html">+</a></code> describes new parameters created within/by object and <code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code> describes object taken from previous steps. After loading data from rice pre-processing code is applied. pre-processed data is converted to <code>cdisc_data</code> object and passed to shiny app alongside with specified <code>server</code> and <code>ui</code>.</p>
<div id="htmlwidget-61cd8a86796a646f1c71" style="width:672px;height:384px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-61cd8a86796a646f1c71">{"x":{"code":"\n  #fill: #FEFEFF\n  #lineWidth: 1\n  #zoom: 4\n  #direction: right\n   #spacing: 88\n#arrowSize: .5\n\n[<frame>App Setup|\n   \n  [DataConnector|\n     + DatasetConnector(dataname, keys, labels)..*\n     + code]\n [<frame>teal::init()]\n [ui]\n [server]\n \n [DataConnector] -> [<frame>teal::init()]\n [ui] -> [<frame>teal::init()]\n [server] -> [<frame>teal::init()]\n \n]\n\n[<frame>Application|\n  [Auth App|\n     + login\n     + password\n     / rice data]\n  \n  [Shiny App|\n    / ui\n    / server\n    / datasets]\n\n  [<transceiver>pre-processing|\n    / rice data\n    / code\n  ]\n  [<database>rice API| + rice data]\n\n  [Auth App] login, pass-> [<database>rice API] \n  [<database>rice API] rice_data -> [Auth App]\n  \n  [Auth App] -> rice_data[pre-processing] \n  [pre-processing] -> cdisc_data[Shiny App]\n]\n\n[App Setup] -> [Application]","svg":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="creating-new-connectors" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-new-connectors" class="anchor"></a>Creating new connectors</h3>
<p>Framework created to handle remote is managed by <code>DataConnector</code> but whole process involves four classes, each described in separate section. General purpose of <code>DataConnector</code> is to get extra arguments to functions which loads data. Some arguments like passwords or logins are impossible to include in app pre-processing, so we propose <code>DataConnector</code> which runs shiny application to get additional parameters.</p>
<div id="callablefunction" class="section level4">
<h4 class="hasAnchor">
<a href="#callablefunction" class="anchor"></a>1. <code>CallableFunction</code>
</h4>
<p>Functionality of this class is to store and execute R function, with possibility to get code to reproduce function call. In example below object of class <code>CallableFunction</code> is created which calls <code>data.frame</code> function with provided arguments.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fun &lt;-<span class="st"> </span>teal<span class="op">:::</span>CallableFunction<span class="op">$</span><span class="kw">new</span>(data.frame)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">fun<span class="op">$</span><span class="kw">set_args</span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">y =</span> letters[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># check reproducible code</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(fun<span class="op">$</span><span class="kw">get_call</span>())</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; data.frame(x = 1:5, y = c("a", "b", "c", "d", "e"))</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># execte function with passed arguments</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">fun<span class="op">$</span><span class="kw">run</span>()</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;   x y</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; 1 1 a</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; 2 2 b</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; 3 3 c</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; 4 4 d</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 5 5 e</span></a></code></pre></div>
</div>
<div id="datasetconnector" class="section level4">
<h4 class="hasAnchor">
<a href="#datasetconnector" class="anchor"></a>2. <code>DatasetConnector</code>
</h4>
<p>Objects of this class store connection function for single dataset with additional attributes associated to this dataset. Object must have a <code>dataname</code> set and function to get data. In the example below constructing new <code>DatasetConnector</code> is wrapped by <code>foo_dataset</code> function which shows how we expose connectors to the developers. We use <code>fun</code> object created in previous code chunk. This wrapper is rather toy example, but one can see the code of <code>rice_dataset</code> to see similarity and understand how to create another wrapper.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">foo_dataset &lt;-<span class="st"> </span><span class="cf">function</span>(dataname, fun) {</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  dc &lt;-<span class="st"> </span>teal<span class="op">:::</span>DatasetConnector<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  dc<span class="op">$</span><span class="kw">set_dataname</span>(dataname)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  dc<span class="op">$</span><span class="kw">set_pull_fun</span>(fun)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(dc)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">}</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">foo &lt;-<span class="st"> </span><span class="kw">foo_dataset</span>(<span class="st">"ADSL"</span>, fun) </a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co"># get reproducible code</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">foo<span class="op">$</span><span class="kw">get_call</span>()</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">#&gt; [1] "ADSL &lt;- data.frame(x = 1:5, y = c(\"a\", \"b\", \"c\", \"d\", \"e\"))"</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co"># execute function - get data</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">foo<span class="op">$</span><span class="kw">get_data</span>()</a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;   x y</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 1 1 a</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 2 2 b</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 3 3 c</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; 4 4 d</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; 5 5 e</span></a></code></pre></div>
</div>
<div id="dataconnection" class="section level4">
<h4 class="hasAnchor">
<a href="#dataconnection" class="anchor"></a>3. <code>DataConnection</code>
</h4>
<p>This class is responsible to set connection with remote data source. <code>DataConnection</code> opens and closes connection. For example <code>rice_connection</code> uses following lines of code. This class doesn’t load data. Class is used before and after data loading. Code for opening and closing connection will be added to R code generated by teal apps.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">open_fun &lt;-<span class="st"> </span>teal<span class="op">:::</span>CallableFunction<span class="op">$</span><span class="kw">new</span>(rice<span class="op">::</span>rice_session_open)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">close_fun &lt;-<span class="st"> </span>teal<span class="op">:::</span>CallableFunction<span class="op">$</span><span class="kw">new</span>(rice<span class="op">::</span>rice_session_close)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">close_fun<span class="op">$</span><span class="kw">set_args</span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">message =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">x &lt;-<span class="st"> </span>teal<span class="op">:::</span>DataConnection<span class="op">$</span><span class="kw">new</span>() <span class="co"># nolint</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">x<span class="op">$</span><span class="kw">set_open_fun</span>(open_fun)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">x<span class="op">$</span><span class="kw">set_close_fun</span>(close_fun)</a></code></pre></div>
</div>
<div id="dataconnector" class="section level4">
<h4 class="hasAnchor">
<a href="#dataconnector" class="anchor"></a>4. <code>DataConnector</code>
</h4>
<p>This class spins previously described elements and creates shiny application to obtain additional arguments. Once again <code>DatasetConnector</code>(s) and <code>DatasetConnection</code> are created using <code>rcd_dataset</code> and <code>rcd_connection</code> respectively.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(random.cdisc.data)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">connectors &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="kw"><a href="../reference/rcd_dataset.html">rcd_dataset</a></span>(<span class="st">"ADSL"</span>, radsl, <span class="dt">cached =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="kw"><a href="../reference/rcd_dataset.html">rcd_dataset</a></span>(<span class="st">"ADLB"</span>, radlb, <span class="dt">cached =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">con &lt;-<span class="st"> </span>teal<span class="op">:::</span><span class="kw"><a href="../reference/rcd_connection.html">rcd_connection</a></span>()</a></code></pre></div>
<p>In code chunk below <code>shiny</code> <code>ui</code> element is created which is going to be displayed on the first app screen. <strong>Important:</strong> ui should contain submit button which confirms that choice have been made.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">ui &lt;-<span class="st"> </span><span class="cf">function</span>(id) {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  ns &lt;-<span class="st"> </span><span class="kw">NS</span>(id)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    <span class="kw">numericInput</span>(<span class="kw">ns</span>(<span class="st">"seed"</span>), <span class="st">"Choose seed"</span>, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">1000</span>, <span class="dt">value =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="kw">actionButton</span>(<span class="kw">ns</span>(<span class="st">"submit"</span>), <span class="st">"Submit"</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">}</a></code></pre></div>
<p><code>DatasetConnector</code>(s), <code>DataConnection</code> and ui element are put into <code>DataConnector</code>. <strong>Important:</strong> <code>set_server_helper</code> handles chosen inputs in app. <code>DataConnector</code> checks if user confirmed inputs by listening ui element linked by <code>submit_id = "submit"</code>. After submitting inputs are saved in class object. One can use helper method <code>x$launch</code> which opens shiny application where one can choose <code>seed</code> for random data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">x &lt;-<span class="st"> </span>teal<span class="op">:::</span>DataConnector<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">x<span class="op">$</span><span class="kw">set_connection</span>(con)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">x<span class="op">$</span><span class="kw">set_connectors</span>(connectors)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">x<span class="op">$</span><span class="kw">set_code</span>(<span class="dt">code =</span> <span class="st">"ADSL$x &lt;- 1"</span>)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">x<span class="op">$</span><span class="kw">set_ui</span>(ui)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">x<span class="op">$</span><span class="kw">set_server_helper</span>(</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">  <span class="dt">submit_id =</span> <span class="st">"submit"</span>,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  <span class="dt">fun_args_fixed =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">seed =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(input<span class="op">$</span>seed))</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">x<span class="op">$</span><span class="kw">launch</span>()</a></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">cdisc_data &lt;-<span class="st"> </span>x<span class="op">$</span><span class="kw">get_cdisc_data</span>()</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; Close connection function not set</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Close connection function not set</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(cdisc_data, <span class="st">"code"</span>))</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; library(package = "random.cdisc.data")</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; ADSL &lt;- radsl(cached = TRUE)</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; ADLB &lt;- radlb(cached = TRUE)</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; ADSL$x &lt;- 1</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; ## </span><span class="al">NOTE</span><span class="co">: Reproducibility of data import and preprocessing was not</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; ## explicitly checked (argument "check = FALSE" is set).</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; ## The app developer has the choice to check the reproducibility</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; ## and might have omitted this step for some reason. Please reach</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co">#&gt; ## out to the app developer for details.</span></a></code></pre></div>
<p>To confirm that shiny input has been saved, one can check reproducible code to see that <code>seed</code> matches app user choice.</p>
</div>
<div id="uml-diagram" class="section level4">
<h4 class="hasAnchor">
<a href="#uml-diagram" class="anchor"></a>UML diagram</h4>
<div id="htmlwidget-083f17ed967908c51f91" style="width:672px;height:384px;" class="nomnoml html-widget"></div>
<script type="application/json" data-for="htmlwidget-083f17ed967908c51f91">{"x":{"code":"\n  #fill: #FEFEFF\n  #lineWidth: 1\n  #zoom: 4\n  #direction: right\n     #spacing: 88\n  #arrowSize: .5\n  [CallableFunction||\n     + init(Function fun)\n     + get_call()\n     + set_args(args)\n     + set_arg_value(name, value)\n     + run()|\n     - function fun_name\n     - list args \n     - character call]\n\n  [DatasetConnector||\n     + get_call()\n     + get_data()\n     + get_dataname()\n     + set/get_dataname(dataname)\n     + set/get_pull_fun(CallableFunction fun)\n     + set/get_pull_fun_args(args)\n     + set/get_pull_arg_value(name, value)|\n     - list data\n     - character dataname\n     - list keys\n     - character labels\n     - character path\n     - CallableFunction pull_fun\n     ]\n  \n  [DataConnection||\n    + set_open_fun(CallableFunction)\n    + set_open_args(args)\n    + set_close_fun(CallableFunction)\n    + set_close_args(args)|\n    - CallableFunction open_fun\n    - CallableFunction close_fun\n  ]\n        \n  [DataConnector||\n    + launch()\n    + get_cdisc_data()\n    + get/set_ui(ui)\n    + get/set_server(server)\n    + get/set_connection(DataConnection)\n    + get/set_connectors(DatasetConnector)\n    + get/set_code(code)|\n    - server\n    - ui\n    - cdisc_data\n    - DataConnection connection 0..1\n    - DatasetConnectors connectors 1..\n    - character code\n    - logical check\n    - list data\n  ]\n\n\n  [CallableFunction] -> [DatasetConnector]\n  [CallableFunction] -> [DataConnection]\n\n  [DataConnection] -> [DataConnector]\n  [DatasetConnector] -> [DataConnector]","svg":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by NEST, Adrian Waddell, Pawel Rucki, Dawid Kaledkowski, Sebastian Wolf, Maximilian Mordig, Bartosz Baranowski, Ondrej Slama, Roche.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
