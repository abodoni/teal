<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teal Design and Implementation • teal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Teal Design and Implementation">
<meta property="og:description" content="teal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">teal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/delayed_data_loading.html">Delayed Data Loading</a>
    </li>
    <li>
      <a href="../articles/developer_apps.html">Developer Apps</a>
    </li>
    <li>
      <a href="../articles/filter_panel.html">Filter panel</a>
    </li>
    <li>
      <a href="../articles/getting_started.html">Getting Started with Teal</a>
    </li>
    <li>
      <a href="../articles/teal_design_and_implementation.html">Teal Design and Implementation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown">
	<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../../pre-release/index.html">pre-release</a></li>
   <li><a href="../../v0.10.0/index.html">v0.10.0</a></li>
   <li><a href="../../v0.9.5/index.html">v0.9.5</a></li>
   <li><a href="../../v0.9.4/index.html">v0.9.4</a></li>
   <li><a href="../../v0.9.3/index.html">v0.9.3</a></li>
   <li><a href="../../v0.9.2/index.html">v0.9.2</a></li>
   <li><a href="../../v0.9.1/index.html">v0.9.1</a></li>
   <li><a href="../../v0.9.0/index.html">v0.9.0</a></li>
   <li><a href="../../v0.8.5/index.html">v0.8.5</a></li>
   <li><a href="../../v0.8.4/index.html">v0.8.4</a></li>
   <li><a href="../../v0.8.3/index.html">v0.8.3</a></li>
   <li><a href="../../v0.8.2/index.html">v0.8.2</a></li>
   <li><a href="../../v0.7.0/index.html">v0.7.0</a></li>
   <li><a href="../../v0.6.0/index.html">v0.6.0</a></li>
   <li><a href="../../v0.0.5/index.html">v0.0.5</a></li>
   <li><a href="../../v0.0.4/index.html">v0.0.4</a></li>
   <li><a href="../../v0.0.3/index.html">v0.0.3</a></li>
   <li><a href="../../v0.0.2/index.html">v0.0.2</a></li>
   <li><a href="../../v0.0.1/index.html">v0.0.1</a></li>
</ul></li>
<!-- end_releases -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/insightsengineering/teal">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="teal_design_and_implementation_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Teal Design and Implementation</h1>
                        <h4 class="author">Adrian Waddell</h4>
            
            <h4 class="date">10/29/2017</h4>
      
      
      <div class="hidden name"><code>teal_design_and_implementation.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette describes the core design of <code>teal</code> and explains some of <code>teal</code>’s implementation details.</p>
<p><code>teal</code> is a framework built on top of <code>Shiny</code> that adds:</p>
<ul>
<li>data filtering on a variable basis combined with <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code> logic</li>
<li>API to request the underlying R code of an output</li>
<li>modularized approach to build customized web-apps with <code>teal</code> modules</li>
</ul>
<p><code>teal</code> modules are <code>Shiny</code> modules with an additional <code>datasets</code> argument for the <code>server</code> function that provides an access to the filtered data.</p>
</div>
<div id="shiny-basics" class="section level1">
<h1 class="hasAnchor">
<a href="#shiny-basics" class="anchor"></a>Shiny Basics</h1>
<p>Shiny apps have the following two main components: the <code>server</code> function and an <code>ui</code> object. The <code>ui</code> object is a representation of the <code>HTML</code> for the webpage and the <code>server</code> function provides the logic to modify the HTML code. Hence, a minimal Shiny app with no server logic is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.rstudio.com/">shiny</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>
  ui <span class="op">=</span> <span class="va">tags</span><span class="op">$</span><span class="fu">p</span><span class="op">(</span><span class="st">"Hello World"</span><span class="op">)</span>,
  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
<p>You can paste this code to the <code>R</code> command line which will initialize the Shiny app. <code>Shiny</code> provides a <a href="https://shiny.rstudio.com/articles/reactivity-overview.html">reactivity programming model</a> to update and get information from the ui:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>
  ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span>
      inputId <span class="op">=</span> <span class="st">"select_data"</span>,
      label <span class="op">=</span> <span class="st">"select data"</span>,
      choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iris"</span>, <span class="st">"mtcars"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span>outputId <span class="op">=</span> <span class="st">"scatterplotmatrix"</span><span class="op">)</span>
  <span class="op">)</span>,
  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span><span class="op">$</span><span class="va">scatterplotmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
      <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">$</span><span class="va">select_data</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">data</span> <span class="op">==</span> <span class="st">"iris"</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>, <span class="op">-</span><span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>
      <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>Note that reactivity is used on the server side for capturing the input (i.e. <code>input$select_data</code>) and to update the output (i.e. <code>output$scatterplot</code>). On the ui side Shiny keeps the <code>HTML</code> code up-to-date and propagates user interface input changes to the reactive environment on the server side. Please inspect the <code>HTML</code> code from the previous example app while the app is running with Chrome’s developer tools and then stop the Shiny app and compare that <code>HTML</code> code with the ui code created by running the following code in the R console:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span>
    inputId <span class="op">=</span> <span class="st">"select_data"</span>,
    label <span class="op">=</span> <span class="st">"select data"</span>,
    choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iris"</span>, <span class="st">"mtcars"</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span>outputId <span class="op">=</span> <span class="st">"scatterplotmatrix"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p><a href="https://shiny.rstudio.com/articles/modules.html">Shiny modules</a> provide an elegant way to split both the <em>ui</em> object and <em>server</em> function into reusable and self-contained functions. Please read the <a href="https://shiny.rstudio.com/articles/modules.html">official tutorial</a> and note that input and output elements are separated by using namespaces. For the above example, we can modularize the selection and the plotting of the data as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ui_example</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagList.html">tagList</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html">selectInput</a></span><span class="op">(</span>
      inputId <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">"select_data"</span><span class="op">)</span>,
      label <span class="op">=</span> <span class="st">"select data"</span>,
      choices <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"iris"</span>, <span class="st">"mtcars"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span>outputId <span class="op">=</span> <span class="fu">ns</span><span class="op">(</span><span class="st">"scatterplotmatrix"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">}</span>

<span class="va">srv_example</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">output</span><span class="op">$</span><span class="va">scatterplotmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">$</span><span class="va">select_data</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">data</span> <span class="op">==</span> <span class="st">"iris"</span><span class="op">)</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
      <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>, <span class="op">-</span><span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Note that <code>ui_example</code> and <code>srv_example</code> functions constitute our <em>example</em> module. To use this module twice in an app run the following code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>
  ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/tagList.html">tagList</a></span><span class="op">(</span><span class="fu">ui_example</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"first"</span><span class="op">)</span>,
            <span class="fu">ui_example</span><span class="op">(</span>id <span class="op">=</span> <span class="st">"second"</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>,
  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span><span class="va">srv_example</span>, id <span class="op">=</span> <span class="st">"first"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span><span class="va">srv_example</span>, id <span class="op">=</span> <span class="st">"second"</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>Note that because of the namespace <code>id</code> the two modules do not conflict with their <code>HTML</code> ids and reactivity names. Please inspect the <code>HTML</code> code for the above example and pay attention to the <code>HTML</code> <code>id</code> attributes.</p>
<p>Here is a visual representation of this modularization:</p>
<p><img src="images/design_shiny_module.png" width="356"></p>
<p>This modularized construction of Shiny apps is one of the foundations of <code>teal</code>. Modularizing code also makes it easier to build a company wide standard for creating and sharing Shiny code and also for creating project specific applications quickly.</p>
<p>Finally, the user interface layout in the version of Shiny we currently support is based on <a href="http://bootstrapdocs.com/v3.0.3/docs/">Bootstrap 3</a> when using the <code>fluidPage</code> and <code>fixedPage</code> layout functions (which we do for <code>teal</code>). Understanding the bootstrap framework for layout, class and css association is useful for creating clean user interfaces.</p>
</div>
<div id="the-teal-overall-design" class="section level1">
<h1 class="hasAnchor">
<a href="#the-teal-overall-design" class="anchor"></a>The Teal Overall Design</h1>
<p>The general <code>teal</code> workflow is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>pass a collection of data sets and a collection of configured teal modules to the <code><a href="../reference/init.html">teal::init</a></code> function.</p></li>
<li><p><code><a href="../reference/init.html">teal::init</a></code> composes the <code>ui</code> and <code>server</code> functions that can then be passed to the <code><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shiny::shinyApp</a></code> function</p></li>
</ol>
<p><img src="images/design_use_teal.png" width="676"></p>
<p>A simple example for a completely custom <code>teal</code> module is the following</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">teal</span><span class="op">)</span>

<span class="va">app</span> <span class="op">&lt;-</span> <span class="fu">teal</span><span class="fu">::</span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>
  data <span class="op">=</span> <span class="fu"><a href="../reference/teal_data.html">teal_data</a></span><span class="op">(</span><span class="fu"><a href="../reference/dataset.html">dataset</a></span><span class="op">(</span><span class="st">"IRIS"</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">)</span><span class="op">)</span>,
  modules <span class="op">=</span> <span class="fu"><a href="../reference/root_modules.html">root_modules</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span>
      label <span class="op">=</span> <span class="st">"sample module"</span>,
      server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">datasets</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">output</span><span class="op">$</span><span class="va">scatterplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="op">{</span>
          <span class="va">iris</span> <span class="op">&lt;-</span> <span class="va">datasets</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"IRIS"</span>, filtered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
          <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, col <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span><span class="op">)</span>
      <span class="op">}</span>,
      ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">datasets</span><span class="op">)</span> <span class="op">{</span>
        <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"scatterplot"</span><span class="op">)</span><span class="op">)</span>
      <span class="op">}</span>,
      filters <span class="op">=</span> <span class="st">"IRIS"</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">app</span><span class="op">$</span><span class="va">ui</span>, <span class="va">app</span><span class="op">$</span><span class="va">server</span><span class="op">)</span></code></pre></div>
<p>Please run the above code by copy-pasting it to the command line. The example shows how simple it is to create a module that has no dynamic encodings but still is interactive due to the possibility of filtering the data.</p>
<p>The default <code>teal</code> web application has the following components:</p>
<p><img src="images/teal_containers.png" width="350"></p>
<ul>
<li>the composition of the Shiny app <code>ui</code> object is based on the [<code>tabsetPanel</code>]</li>
<li>the composition of the <code>server</code> function is based on the modules as illustrated here:</li>
</ul>
<p><img src="images/design_teal.png" width="264"></p>
<p>The important new parts in the above diagram are:</p>
<ul>
<li><p>the <code>datasets</code> object that filters the analysis data and provides an interface to access and modify the data and variable based filtering. The <code>datasets</code> object is of class <code>FilteredData</code> which uses the <a href="https://r6.r-lib.org/articles/Introduction.html"><code>R6</code></a> object system.</p></li>
<li><p>Filter panel related code: that is module encapsulated within <code>FilteredData</code>.</p></li>
<li><p>Shiny’s [<code>tabsetPanel</code>] for displaying only one analysis module at a time (e.g. the one with a bold outline). The modules that are not active (visible) get the attribute <code>class=invisible</code> in the HTML code. Note that the <code>HTML</code> for each module is always present in your app ui <code>HTML</code> code.</p></li>
</ul>
<p>These have been the three main challenges (in addition to code reproducibility) when designing and implementing <code>teal</code>. The relevant R-code for these main parts are in the <a href="https://github.com/insightsengineering/teal">teal repository</a> in the following files:</p>
<ul>
<li>
<code>R/FilteredData.R</code>, <code>R/FilteredDataset.R</code>, <code>R/FilterStates.R</code>, <code>R/FilterState.R</code>
</li>
<li>
<code>R/init.R</code>,</li>
</ul>
<p>We have also a logging facility with the <code>.log</code> function with the corresponding code saved in <code>R/logging.R</code>. Logging to the prompt can be disabled with <code><a href="https://rdrr.io/r/base/options.html">options(teal_logging = FALSE)</a></code>.</p>
<p>We now discuss each of the three core components in detail. This would be a good time to browse through the just mentioned <code>.R</code> files and see how much of what has just been said/written can be spotted in the code without further explanation.</p>
<div id="filtereddata" class="section level2">
<h2 class="hasAnchor">
<a href="#filtereddata" class="anchor"></a>FilteredData</h2>
<p>The <code>FilteredData</code> class is an <a href="https://r6.r-lib.org/articles/Introduction.html"><code>R6</code></a> reference class to handle the datasets and the filtering state. In general, every dataset can be filtered based on values of its variables.</p>
<ul>
<li><p>if a variable <code>xi</code> is continuous or date/date time then the filtering is based on a range: <code>xi in [a,b]</code> where <code>min(xi)&lt;=a&lt;b&lt;=max(xi)</code></p></li>
<li><p>if a variable <code>xi</code> is categorical then the filtering is based on a set: <code>xi in A</code> where <code>A</code> is a subset of the elements in <code>xi</code>.</p></li>
</ul>
<p>When filtering a dataset, say <code>ADSL</code>, with <code>10</code> of its variables then the <code>10</code> subsetting conditions are combined with an logical AND (<code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code>). If a more complicated subsetting is needed then it is easiest to add a new variable to the analysis dataset that contains the desired logic which then in turn can be combined via <code><a href="https://rdrr.io/r/base/Logic.html">&amp;</a></code> logic with other variable based subsetting conditions.</p>
<div id="clinical-trials-data" class="section level3">
<h3 class="hasAnchor">
<a href="#clinical-trials-data" class="anchor"></a>Clinical Trials Data</h3>
<p>In order to understand the current implementation of the <code>FilteredData</code> class it is useful to have some background of the data standards used in clinical trials.</p>
<p>For clinical trials the datasets are standardized following the <a href="https://www.cdisc.org">CDISC</a> standards <a href="https://www.cdisc.org/standards/foundational/sdtm">SDTM</a> and <a href="https://www.cdisc.org/standards/foundational/adam">ADaM</a>. Both SDTM and ADaM are based on rectangular data structures and a simplified generalization is that SDTM contains observed raw data and ADaM adds metadata and derives new data so that an output (table/graph) can be computed directly from a single ADaM data set. Here is a diagram of some SDTM datasets:</p>
<p><img src="images/sdtm_overview.png" width="80%"></p>
<p>The names of ADaM datasets often prefix a <code>AD</code> or <code>A</code> to their corresponding <code>SDTM</code> dataset names.</p>
<p>There is one particularly important dataset called <code>ADSL</code> or <code>ADLS</code> that contains patient information (e.g. Unique Subject Identifier <code>USUBJID</code>, <code>ARM</code>, <code>SEX</code>, <code>Age</code>, randomization date, etc.) with one row per patient. Often this dataset is merged to all other <code>ADaM</code> datasets as its information is frequently used for most outputs (e.g. <code>ARM</code>). The key for merging <code>ADSL</code> and any other analysis dataset is the <code>USUBJID</code> and <code>STUDYID</code> variable (if not specified otherwise).</p>
</div>
<div id="filtereddata-class-for-clinical-trials-data" class="section level3">
<h3 class="hasAnchor">
<a href="#filtereddata-class-for-clinical-trials-data" class="anchor"></a>FilteredData Class for Clinical Trials Data</h3>
<p><code>teal</code> supports both general relational data (using <code>teal_data</code> function output as <code>data</code> argument to <code><a href="../reference/init.html">teal::init</a></code>) and CDISC specific data (using <code>cdisc_data</code> function instead)</p>
<p>When using CDISC specific data, the filtering mechanism makes use of <code>ADSL</code> being a “special” dataset as described below.</p>
<p><img src="images/design_cdisc_filtered_datasets.png" width="100%"></p>
<p>This filtering will now be explained step by step for two example datasets (<code>ADSL</code> and <code>ADTTE</code>):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># for reproducibility</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>

<span class="va">ADSL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="co">#nolint</span>
  USUBJID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"id-"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>,
  STUDYID <span class="op">=</span> <span class="st">"studyA"</span>,
  AGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, sd <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="fl">40</span><span class="op">)</span>,
  SEX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span>, <span class="fl">100</span>, <span class="cn">TRUE</span><span class="op">)</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">ADTTE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> <span class="co">#nolint</span>
  USUBJID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"id-"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>,
  STUDYID <span class="op">=</span> <span class="st">"studyA"</span>,
  AVAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">100</span>, rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>,
  CNSR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">100</span>, <span class="cn">TRUE</span><span class="op">)</span>,
  PARAMCD <span class="op">=</span> <span class="st">"OS"</span>,
  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>The <code>datasets</code> object of class <code>CDISCFilteredData</code> that is passed an argument to the <code>server</code> function is created by <code>teal</code> as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">teal</span><span class="op">)</span></code></pre></div>
<pre><code>## 
## You are using teal version 0.10.0</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>teal_logging <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="va">datasets</span> <span class="op">&lt;-</span> <span class="fu">teal</span><span class="fu">:::</span><span class="va"><a href="../reference/CDISCFilteredData.html">CDISCFilteredData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
<span class="co"># the `datasets` object contains reactives</span>
<span class="co"># we activate this option, so we don't need to wrap all reactives in isolate calls</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>shiny.suppressMissingContextError <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">datasets</span><span class="op">$</span><span class="fu">set_dataset</span><span class="op">(</span><span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span><span class="op">)</span><span class="op">)</span>
<span class="va">datasets</span><span class="op">$</span><span class="fu">set_dataset</span><span class="op">(</span><span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADTTE"</span>, <span class="va">ADTTE</span><span class="op">)</span><span class="op">)</span>
<span class="fu">shiny</span><span class="fu">:::</span><span class="fu">flushReact</span><span class="op">(</span><span class="op">)</span> <span class="co"># force evaluation outside of Shiny apps</span></code></pre></div>
<p>Now say we want to filter out all the patients in <code>ADSL</code> except patients with <code>USUBJID</code> equal to <code>id-1</code>, <code>id-2</code>, <code>id-3</code>, or <code>id-4</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/testServer.html">testServer</a></span><span class="op">(</span>
  <span class="va">datasets</span><span class="op">$</span><span class="va">set_bookmark_state</span>,
  args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
      ADSL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        USUBJID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"id-%s"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>,
  expr <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span>

<span class="va">datasets</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"ADSL"</span>, filtered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>##   USUBJID STUDYID      AGE SEX
## 1    id-1  studyA 27.47092   F
## 2    id-2  studyA 43.67287   F
## 3    id-3  studyA 23.28743   M
## 4    id-4  studyA 71.90562   F</code></pre>
<p>Note that this <code>USUBJID</code> variable based filtering also filters the <code>ADTE</code> data (with an inner join based on <code>USUBJID</code> and <code>STUDYID</code>), as illustrated in the previous figure:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datasets</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"ADTTE"</span>, filtered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Joining, by = c("USUBJID", "STUDYID")</code></pre>
<pre><code>##   USUBJID STUDYID      AVAL CNSR PARAMCD      AGE SEX
## 1    id-1  studyA  6.948489    0      OS 27.47092   F
## 2    id-2  studyA 51.943345    0      OS 43.67287   F
## 3    id-3  studyA 19.064549    0      OS 23.28743   M
## 4    id-4  studyA 35.942001    0      OS 71.90562   F</code></pre>
<p>The two <code>get_data</code> method calls return the <code>ADSL_FILTERED</code> and <code>ADTTE_FILTERED</code> data, respectively, as illustrated from the above figure. We can also get the <code>call</code> object that was used for the filtering:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/get_filter_expr.html">get_filter_expr</a></span><span class="op">(</span><span class="va">datasets</span>, <span class="st">"ADTTE"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## ADTTE_FILTERED_ALONE &lt;- ADTTE
## ADTTE_FILTERED &lt;- dplyr::inner_join(x = ADTTE_FILTERED_ALONE, y = ADSL_FILTERED)</code></pre>
</div>
<div id="filtereddata-for-general-relational-data" class="section level3">
<h3 class="hasAnchor">
<a href="#filtereddata-for-general-relational-data" class="anchor"></a>FilteredData for general relational data</h3>
<p>The CDISC filtering mechanism which we have introduced in the previous section can be abstracted with the following diagram:</p>
<p><img src="images/design_cdisc_filtered_data.png" width="213"></p>
<p>This is, however, a very particular filtering setup that has not much use besides analyzing clinical trials data that follows CDISC standards. A more general filtering is to have variable based filtering for an arbitrary dataset:</p>
<p><img src="images/design_one_dataset_filtered_data.png" width="96"></p>
<p>or more generally a collection of independently filtered datasets:</p>
<p><img src="images/design_simple_filtered_data.png" width="204"></p>
<p>This filtering is implemented using the <code>FilteredData</code> class (which is created when using the <code>teal_data</code> and which <code>CDISCFilteredData</code> inherits from).</p>
<p>In the future we may also need filtering for <a href="https://www.bioconductor.org/packages/3.7/bioc/vignettes/Biobase/inst/doc/ExpressionSetIntroduction.pdf">expression sets</a></p>
<p><img src="images/expressionset.png" width="346"></p>
<p>that is, filtering expression sets is a slightly more advanced filtering as one probably wants to filter the biomarker data on a sample level but also on gene metadata level (filter columns and rows).</p>
<p>In terms of refactoring <code>teal</code> this means changes to the <code>FilteredData</code> class hierarchy</p>
</div>
</div>
<div id="composition-of-the-ui-and-server-functions-with-tealinit" class="section level2">
<h2 class="hasAnchor">
<a href="#composition-of-the-ui-and-server-functions-with-tealinit" class="anchor"></a>Composition of the ui and server functions with <code>teal::init</code>
</h2>
<p>In this section we discuss the code in <code>R/init.R</code>. The <code>init</code> function composes the <code>ui</code> object and the <code>server</code> function which are returned and then passed to <code>shinyApp</code> to start the web app.</p>
<p>The datasets passed to the <code>data</code> arguments get encapsulated within the <code>init</code> function into a local instance of <code>FilteredData</code> or <code>CDISCFilteredData</code> (i.e. the <code>datasets</code> object).</p>
<p>Next, the <code>ui</code> object is created. The composition of ui and server happens entirely with the object passed via <code>modules</code>, <code>header</code>, and <code>footers</code> arguments. The <code>modules</code> object is a tree of <code><a href="../reference/modules.html">modules()</a></code> (nested lists) with currently a constrained depth of 2. The composition of the ui functions defined in <code>modules</code> happens recursively via the <code>create_ui</code> function. Note that the <code>create_ui</code> function call happens in a local environment as we modify the returned object structure to add the filter panel on the right hand side (this improves the UI as it places the filter panel below the <code>tabsetPanel</code> menu).</p>
<p>Also note that the added javascript in the <code>ui</code> object is necessary to manually interrupt reactivity when hiding the ui elements for filtering based on variables that are not relevant for a particular analysis (i.e. we do not show <code>ADRS</code> filter variables if we analyse an output based on <code>ADTTE</code>).</p>
<p>Next: the creation of the server function. The easy part is the composition of the module server functions which happens with the <code>call_modules</code> function call.</p>
</div>
</div>
<div id="embed-teal-into-other-applications" class="section level1">
<h1 class="hasAnchor">
<a href="#embed-teal-into-other-applications" class="anchor"></a>Embed teal into other applications</h1>
<p>Here is an example of an app with two independent teal applications side-by-side. The same idea can be used to embed it into other Shiny modules. We use the <code>id</code> argument of the <code>init</code> function for this.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">random.cdisc.data</span><span class="op">)</span>

<span class="va">ADSL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/random.cdisc.data/man/radsl.html">radsl</a></span><span class="op">(</span>cached <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#nolint</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>teal_logging <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Code to have two teal apps side-by-side or embed it in a larger application</span>
<span class="va">create_teal_app</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">title</span>, <span class="va">id</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span>
    data <span class="op">=</span> <span class="fu"><a href="../reference/cdisc_data.html">cdisc_data</a></span><span class="op">(</span>
      <span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span>, code <span class="op">=</span> <span class="st">"ADSL &lt;- radsl(cached = TRUE)"</span><span class="op">)</span>
    <span class="op">)</span>,
    modules <span class="op">=</span> <span class="fu"><a href="../reference/root_modules.html">root_modules</a></span><span class="op">(</span>
      <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span>
        <span class="st">"data source"</span>,
        server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">datasets</span><span class="op">)</span> <span class="cn">NULL</span>,
        ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"information about data source"</span><span class="op">)</span><span class="op">)</span>,
        filters <span class="op">=</span> <span class="st">"all"</span>
      <span class="op">)</span>,
      <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span>
        <span class="st">"ADSL AGE histogram"</span>,
        server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">datasets</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">output</span><span class="op">$</span><span class="va">hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"ADSL"</span>, filtered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">AGE</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>,
        ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"hist"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>,
        filters <span class="op">=</span> <span class="st">"ADSL"</span>
      <span class="op">)</span>
    <span class="op">)</span>,
    filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ADSL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>AGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
    header <span class="op">=</span> <span class="va">tags</span><span class="op">$</span><span class="fu">h1</span><span class="op">(</span><span class="va">title</span><span class="op">)</span>,
    footer <span class="op">=</span> <span class="va">tags</span><span class="op">$</span><span class="fu">p</span><span class="op">(</span><span class="st">"Copyright 2017 - 2020"</span><span class="op">)</span>,
    id <span class="op">=</span> <span class="va">id</span>
  <span class="op">)</span>
<span class="op">}</span>
<span class="va">app1</span> <span class="op">&lt;-</span> <span class="fu">create_teal_app</span><span class="op">(</span><span class="st">"Sample App1"</span>, id <span class="op">=</span> <span class="st">"app1"</span><span class="op">)</span>
<span class="va">app2</span> <span class="op">&lt;-</span> <span class="fu">create_teal_app</span><span class="op">(</span><span class="st">"Sample App2"</span>, id <span class="op">=</span> <span class="st">"app2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>
  ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidRow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html">column</a></span><span class="op">(</span><span class="fl">6</span>, <span class="va">app1</span><span class="op">$</span><span class="va">ui</span><span class="op">)</span>,
                          <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html">column</a></span><span class="op">(</span><span class="fl">6</span>, <span class="va">app2</span><span class="op">$</span><span class="va">ui</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span><span class="va">app1</span><span class="op">$</span><span class="va">server</span>, <span class="st">"app1"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span><span class="va">app2</span><span class="op">$</span><span class="va">server</span>, <span class="st">"app2"</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
<p>However, we recommend to use <code>ui_teal_with_splash</code> and <code>srv_teal_with_splash</code> if you would want to use the teal app in the same way as Shiny modules with <code>callModule</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">modules</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/root_modules.html">root_modules</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span>
    <span class="st">"data source"</span>,
    server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">datasets</span><span class="op">)</span> <span class="cn">NULL</span>,
    ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">...</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">div</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">p</a></span><span class="op">(</span><span class="st">"information about data source"</span><span class="op">)</span><span class="op">)</span>,
    filters <span class="op">=</span> <span class="st">"all"</span>
  <span class="op">)</span>,
  <span class="fu"><a href="../reference/module.html">module</a></span><span class="op">(</span>
    <span class="st">"ADSL AGE histogram"</span>,
    server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="va">datasets</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">output</span><span class="op">$</span><span class="va">hist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html">renderPlot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">$</span><span class="fu">get_data</span><span class="op">(</span><span class="st">"ADSL"</span>, filtered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">AGE</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>,
    ui <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/NS.html">NS</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html">plotOutput</a></span><span class="op">(</span><span class="fu">ns</span><span class="op">(</span><span class="st">"hist"</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>,
    filters <span class="op">=</span> <span class="st">"ADSL"</span>
  <span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html">shinyApp</a></span><span class="op">(</span>
  ui <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidPage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html">fluidRow</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html">column</a></span><span class="op">(</span>
      <span class="fl">6</span>,
      <span class="fu"><a href="../reference/ui_teal_with_splash.html">ui_teal_with_splash</a></span><span class="op">(</span><span class="st">"app1"</span>,
                          data <span class="op">=</span> <span class="fu"><a href="../reference/cdisc_data.html">cdisc_data</a></span><span class="op">(</span>
                            <span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span>, code <span class="op">=</span> <span class="st">"ADSL &lt;- radsl(cached = TRUE)"</span><span class="op">)</span>
                          <span class="op">)</span>,
                          title <span class="op">=</span> <span class="st">"Sample app 1"</span><span class="op">)</span>
    <span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/column.html">column</a></span><span class="op">(</span>
      <span class="fl">6</span>,
      <span class="fu"><a href="../reference/ui_teal_with_splash.html">ui_teal_with_splash</a></span><span class="op">(</span><span class="st">"app2"</span>,
                          data <span class="op">=</span> <span class="fu"><a href="../reference/cdisc_data.html">cdisc_data</a></span><span class="op">(</span>
                            <span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span>, code <span class="op">=</span> <span class="st">"ADSL &lt;- radsl(cached = TRUE)"</span><span class="op">)</span>
                          <span class="op">)</span>,
                          title <span class="op">=</span> <span class="st">"Sample app 2"</span><span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>,
  server <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span>
      module <span class="op">=</span> <span class="va">srv_teal_with_splash</span>,
      id <span class="op">=</span> <span class="st">"app1"</span>,
      data <span class="op">=</span> <span class="fu"><a href="../reference/cdisc_data.html">cdisc_data</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span>, code <span class="op">=</span> <span class="st">"ADSL &lt;- radsl(cached = TRUE)"</span><span class="op">)</span>
      <span class="op">)</span>,
      modules <span class="op">=</span> <span class="va">modules</span>
    <span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/callModule.html">callModule</a></span><span class="op">(</span>
      module <span class="op">=</span> <span class="va">srv_teal_with_splash</span>,
      id <span class="op">=</span> <span class="st">"app2"</span>,
      data <span class="op">=</span> <span class="fu"><a href="../reference/cdisc_data.html">cdisc_data</a></span><span class="op">(</span>
        <span class="fu"><a href="../reference/cdisc_dataset.html">cdisc_dataset</a></span><span class="op">(</span><span class="st">"ADSL"</span>, <span class="va">ADSL</span>, code <span class="op">=</span> <span class="st">"ADSL &lt;- radsl(cached = TRUE)"</span><span class="op">)</span>
      <span class="op">)</span>,
      modules <span class="op">=</span> <span class="va">modules</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by NEST, Adrian Waddell, Pawel Rucki, Dawid Kaledkowski, Sebastian Wolf, Maximilian Mordig, Bartosz Baranowski, Ondrej Slama, Nikolas Burkoff, Maciej Nasinski, Roche.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
