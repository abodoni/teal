<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teal Desiderata • teal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Teal Desiderata">
<meta property="og:description" content="teal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">teal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/delayed_data_loading.html">Delayed Data Loading</a>
    </li>
    <li>
      <a href="../articles/developer_apps.html">Developer Apps</a>
    </li>
    <li>
      <a href="../articles/getting_started.html">Getting Started with Teal</a>
    </li>
    <li>
      <a href="../articles/teal_desiderata.html">Teal Desiderata</a>
    </li>
    <li>
      <a href="../articles/teal_design_and_implementation.html">Teal Design and Implementation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../../pre-release/index.html">pre-release</a></li>
   <li><a href="../../v0.10.0/index.html">v0.10.0</a></li>
   <li><a href="../../v0.9.5/index.html">v0.9.5</a></li>
   <li><a href="../../v0.9.4/index.html">v0.9.4</a></li>
   <li><a href="../../v0.9.3/index.html">v0.9.3</a></li>
   <li><a href="../../v0.9.2/index.html">v0.9.2</a></li>
   <li><a href="../../v0.9.1/index.html">v0.9.1</a></li>
   <li><a href="../../v0.9.0/index.html">v0.9.0</a></li>
   <li><a href="../../v0.8.5/index.html">v0.8.5</a></li>
   <li><a href="../../v0.8.4/index.html">v0.8.4</a></li>
   <li><a href="../../v0.8.3/index.html">v0.8.3</a></li>
   <li><a href="../../v0.8.2/index.html">v0.8.2</a></li>
   <li><a href="../../v0.7.0/index.html">v0.7.0</a></li>
   <li><a href="../../v0.6.0/index.html">v0.6.0</a></li>
   <li><a href="../../v0.0.5/index.html">v0.0.5</a></li>
   <li><a href="../../v0.0.4/index.html">v0.0.4</a></li>
   <li><a href="../../v0.0.3/index.html">v0.0.3</a></li>
   <li><a href="../../v0.0.2/index.html">v0.0.2</a></li>
   <li><a href="../../v0.0.1/index.html">v0.0.1</a></li>
</ul></li>
<!-- end_releases -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.roche.com/NEST/teal">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="teal_desiderata_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="teal_desiderata_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Teal Desiderata</h1>
                        <h4 class="author">Adrian Waddell</h4>
            
            <h4 class="date">2019-07-31</h4>
      
      
      <div class="hidden name"><code>teal_desiderata.Rmd</code></div>

    </div>

    
    
<p>This is a list of possible directions to continue the teal development.</p>
<div id="abstract-filtereddata-class" class="section level1">
<h1 class="hasAnchor">
<a href="#abstract-filtereddata-class" class="anchor"></a>Abstract FilteredData Class</h1>
<p>Currently <code>teal</code> implements a filtering model that is useful to for clinical trials data only as it requires an <code>ADSL</code> dataset and that every dataset has the <code>USUBJID</code> and <code>STUDYID</code> variables. Please read the <code>10_teal_design_and_implementation</code> vignette for more details.</p>
<p>The required work is to make the <code>FilteredData</code> class abstract and create concrete classes for particular data models:</p>
<p><img src="images/design_FilteredData.png" width="476"></p>
<p>Note that this also requires to turn the filter panel (which is shown on the left hand side in teal app) into a shiny module that dispatches based on the concrete class inheriting from <code>FilteredData</code>.</p>
</div>
<div id="modularize-teal" class="section level1">
<h1 class="hasAnchor">
<a href="#modularize-teal" class="anchor"></a>Modularize Teal</h1>
<p>Currently teal needs to be a top-level shiny app, i.e.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">teal</span>)

<span class="no">x</span> <span class="kw">&lt;-</span> <span class="kw pkg">teal</span><span class="kw ns">::</span><span class="fu"><a href="../reference/init.html">init</a></span>(<span class="no">...</span>)

<span class="fu">shinyApp</span>(<span class="no">x</span>$<span class="no">ui</span>, <span class="no">x</span>$<span class="no">server</span>)</pre></body></html></div>
<p>It would be great if we could modularize teal itself so that it can be integrated (possibly multiple times) into another enclosing shiny app. For example:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">teal</span>)

<span class="no">teal_instance</span> <span class="kw">&lt;-</span> <span class="kw pkg">teal</span><span class="kw ns">::</span><span class="fu">init_as_module</span>(<span class="no">...</span>)

<span class="no">ui</span> <span class="kw">&lt;-</span> <span class="fu">fluidPage</span>(
  <span class="fu">titlePanel</span>(<span class="st">"Giant App That Uses teal only in one Frame"</span>),

  <span class="fu">sidebarLayout</span>(
    <span class="fu">sidebarPanel</span>(<span class="st">"sidebar panel"</span>),
    <span class="fu">mainPanel</span>(
      <span class="st">"main panel"</span>,
      <span class="no">teal_instance</span>$<span class="fu">ui</span>(<span class="kw">id</span> <span class="kw">=</span> <span class="st">"teal_1"</span>)
    )
  )
)

<span class="no">server</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">input</span>, <span class="no">output</span>, <span class="no">session</span>) {
  <span class="co"># own code and then</span>
  <span class="fu">callModule</span>(<span class="kw">module</span> <span class="kw">=</span> <span class="no">teal_instance</span>$<span class="no">server</span>, <span class="kw">id</span> <span class="kw">=</span> <span class="st">"teal_1"</span>)
}

<span class="fu">shinyApp</span>(<span class="no">ui</span>, <span class="no">server</span>)</pre></body></html></div>
<p>This way we could use multiple instances of teal with possibly different data and data models in one overarching app.</p>
</div>
<div id="save-and-share-state" class="section level1">
<h1 class="hasAnchor">
<a href="#save-and-share-state" class="anchor"></a>Save and Share State</h1>
<p>It would be nice to implement a “Share” or a “Bookmark” button that saves the current state of a teal app (which data was loaded, filters set, encoding settings, etc…) so that an analysis state can be shared.</p>
</div>
<div id="improve-variable-browser" class="section level1">
<h1 class="hasAnchor">
<a href="#improve-variable-browser" class="anchor"></a>Improve Variable Browser</h1>
<p>Currently the <code>tm_variable_browser</code> is very basic. The univariate visualization of the data can be improved (and abstracted). For example,</p>
<ul>
<li>Make a better summary of factor variables with many factor levels</li>
<li>Provide multiple selection for bivariate plots</li>
</ul>
</div>
<div id="improve-the-data-table-view" class="section level1">
<h1 class="hasAnchor">
<a href="#improve-the-data-table-view" class="anchor"></a>Improve the Data Table View</h1>
<p>The <code>tm_data_table</code> module could also need some more basic raw data interaction features. Right now we only allow for frequency counts of unique rows.</p>
<ul>
<li>The dataset selection needs some <code>CSS</code> styling</li>
</ul>
</div>
<div id="split-view" class="section level1">
<h1 class="hasAnchor">
<a href="#split-view" class="anchor"></a>Split View</h1>
<p>Currently only one teal module can be shown at any given time (without manually changing the <code>ui</code> object that is returned by <code><a href="../reference/init.html">teal::init</a></code>). Since it is not possible to start the same shiny app twice it would hence be nice to find a good solution to have two outputs side-by side (with their encoding panels).</p>
</div>
<div id="framework-for-logging-and-analysis-guidance" class="section level1">
<h1 class="hasAnchor">
<a href="#framework-for-logging-and-analysis-guidance" class="anchor"></a>Framework For Logging and Analysis Guidance</h1>
<p>If we were to share an interactive analysis environment with a health authority it would be good to guide (and restrict) them with the analysis that they can make with that app. Although this can be currently done there is no nice framework to do this.</p>
<p>Also it would be good to have a concise logging that shows what which stakeholder has analyzed (e.g. if a teal app is shared with affiliates).</p>
</div>
<div id="class-system-for-teal-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#class-system-for-teal-modules" class="anchor"></a>Class System For Teal Modules</h1>
<p>Right now it is not possible to extend an existing teal module without modifying that module (e.g. by adding arguments). For example for the <code>tm_scatterplot</code> module one might be interested to add a regression line or a loess smoother on top of the points. It would be great to design a teal module system that would allow something like this:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">my_new_module</span> <span class="kw">&lt;-</span> <span class="fu">Class</span>(<span class="kw">expands</span> <span class="kw">=</span> <span class="st">"tm_scatterplot"</span>,
                       <span class="kw">ui</span> <span class="kw">=</span> {
                         <span class="no">x</span> <span class="kw">&lt;-</span> <span class="fu">parent</span>()
                         <span class="fu">tagList</span>(
                           <span class="fu">h1</span>(<span class="st">"new stuff"</span>),
                           <span class="no">x</span>
                         )
                       },
                       <span class="kw">server</span> <span class="kw">=</span> {
                         <span class="no">s</span> <span class="kw">&lt;-</span> <span class="fu">parent</span>()
                         <span class="co"># modify parent reactive expressions</span>
                         <span class="no">output</span>$<span class="no">plot</span> <span class="kw">&lt;-</span> <span class="fu">reactive</span>({
                           <span class="no">gg</span> <span class="kw">&lt;-</span> <span class="no">s</span>$<span class="no">plot</span>

                           <span class="no">gg</span> + <span class="fu">geom_smoot</span>()
                         })
                       }
                       )</pre></body></html></div>
</div>
<div id="module-dependencies" class="section level1">
<h1 class="hasAnchor">
<a href="#module-dependencies" class="anchor"></a>Module Dependencies</h1>
<p>Currently all implemented teal modules are completely independent. However it would be nice to have global states, e.g. the <code>ADSL</code> variable with the study arm information. This probably won’t require huge changes (modules need to optionally accept reactive values as arguments), but I have not done it so far.</p>
</div>
<div id="code-reproducibility" class="section level1">
<h1 class="hasAnchor">
<a href="#code-reproducibility" class="anchor"></a>Code Reproducibility</h1>
<p>We have now three proposed ways to do get reproducible code:</p>
<ol style="list-style-type: decimal">
<li><p>Doug’s way with parsing all the involved code and turn reactive endpoints to ordinary function call (still need to work on that pull-request). This is a general solution that does not require the module developer to do anything.</p></li>
<li><p>Capturing analysis code and the substitute and stack the code manually to match the analysis. It would be nice to implement <code>nameExpression(name, expression)</code> which captures analysis code in a transparent way.</p></li>
<li><p>Delegate the analysis to essentially a function call and have the encoding panel only affect the arguments. E.g.</p></li>
</ol>
<p>The important part here is that there is a clean distinction what teal does and what the teal module developer has to do. For example, for the following code:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">survival</span>)

<span class="co">## Attributes to the datasets that are passed to the init data argument</span>
<span class="no">ADSL</span> <span class="kw">&lt;-</span> <span class="fu">read_bce</span>(<span class="st">'/opt/BIOSTAT/qa/i9999/libraries/asl.sas7bdat'</span>)
<span class="no">ADTTE</span> <span class="kw">&lt;-</span> <span class="fu">read_bce</span>(<span class="st">'/opt/BIOSTAT/qa/i9999/libraries/ate.sas7bdat'</span>)

<span class="co">## Filter Panel</span>
<span class="no">ADSL_f</span> <span class="kw">&lt;-</span> <span class="no">ADSL</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">SEX</span> <span class="kw">==</span> <span class="st">'F'</span>)
<span class="no">ADTTE_filtered</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(<span class="no">ADSL_f</span>, <span class="no">ADTTE</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"USUBJID"</span>, <span class="st">"STUDYID"</span>))


<span class="co">## Teal Module Developer Resposibility (Encoding &amp; Ouptput)</span>
<span class="no">ANL</span> <span class="kw">&lt;-</span> <span class="no">ADTTE_filtered</span> <span class="kw">%&gt;%</span>
          <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">ITTFL</span> <span class="kw">==</span> <span class="st">'Y'</span>, <span class="no">PARAMCD</span> <span class="kw">==</span> <span class="st">'OS'</span>)

<span class="no">p</span> <span class="kw">&lt;-</span> <span class="fu">p_km</span>(
  <span class="kw">formula</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(<span class="no">AVAL</span>, !<span class="no">CNSR</span>) ~ <span class="no">ARM</span> + <span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html">strata</a></span>(<span class="no">ECOG</span>, <span class="no">BAGE</span>),
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">ANL</span>
)</pre></body></html></div>
<p>Also note that the reproducible code should not depend on teal.</p>
</div>
<div id="filter-labels-and-filter-states" class="section level1">
<h1 class="hasAnchor">
<a href="#filter-labels-and-filter-states" class="anchor"></a>Filter Labels and Filter States</h1>
<p>For clinical trials it is custom in Roche/Genetech to define labels that relate to certain subsets of the patients. It would be good to extend the filter panel (right hand side, not in the encoding panel) to facility filter labels, standard filter configurations and reset to standard filter configurations.</p>
<p>Note that a standard filter configuration is supported when initializing the teal app, however it’s not possible to reset to that standard filter state.</p>
</div>
<div id="data-extraction-widget" class="section level1">
<h1 class="hasAnchor">
<a href="#data-extraction-widget" class="anchor"></a>Data Extraction Widget</h1>
<p>As clinical trials data is often in a vertical form is is often necessary to do the following operation in order to get to a particular measure for each patient:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">RAW_DATA</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">PARAM</span> <span class="kw">==</span> <span class="st">"aaa"</span>, <span class="no">ZA</span> <span class="kw">==</span> <span class="st">"bbb"</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">AVAL</span>)</pre></body></html></div>
<p>That is, the filtering is necessary to get to one value of interest per patient and the select is necessary to specify the column where the values are stored. It would be great to create an abstracted filter/select shiny module that provides an intuitive user interface for this. I can extend on this problem if necessary.</p>
</div>
<div id="more-standard-general-teal-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#more-standard-general-teal-modules" class="anchor"></a>More Standard General Teal Modules</h1>
<p>Currently teal comes with the following standard modules:</p>
<ul>
<li>variable browser</li>
<li>data table viewer</li>
<li>scatterplot</li>
<li>cross-table</li>
<li>(I started the scatterplot matrix)</li>
</ul>
<p>It would be nice to extend the catalog of very general modules. Specialized modules (Kaplan-Meier plot, time to event analysis, etc.) live in other packages such as <code>teal.modules.clinical</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by NEST, Adrian Waddell, Pawel Rucki, Dawid Kaledkowski, Sebastian Wolf, Maximilian Mordig, Bartosz Baranowski, Ondrej Slama, Nikolas Burkoff, Maciej Nasinski, Roche.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
