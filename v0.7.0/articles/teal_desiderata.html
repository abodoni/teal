<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teal Desiderata • teal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Teal Desiderata">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">teal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting_started.html">Getting Started with Teal</a>
    </li>
    <li>
      <a href="../articles/teal_desiderata.html">Teal Desiderata</a>
    </li>
    <li>
      <a href="../articles/teal_design_and_implementation.html">Teal Design and Implementation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start_releases -->
<li class="dropdown">
	<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
Other releases
<span class="caret"></span></a><ul class="dropdown-menu" role="menu">
   <li><a href="../../index.html">latest</a></li>
   <li><a href="../../pre-release/index.html">pre-release</a></li>
   <li><a href="../../v0.10.0/index.html">v0.10.0</a></li>
   <li><a href="../../v0.9.5/index.html">v0.9.5</a></li>
   <li><a href="../../v0.9.4/index.html">v0.9.4</a></li>
   <li><a href="../../v0.9.3/index.html">v0.9.3</a></li>
   <li><a href="../../v0.9.2/index.html">v0.9.2</a></li>
   <li><a href="../../v0.9.1/index.html">v0.9.1</a></li>
   <li><a href="../../v0.9.0/index.html">v0.9.0</a></li>
   <li><a href="../../v0.8.5/index.html">v0.8.5</a></li>
   <li><a href="../../v0.8.4/index.html">v0.8.4</a></li>
   <li><a href="../../v0.8.3/index.html">v0.8.3</a></li>
   <li><a href="../../v0.8.2/index.html">v0.8.2</a></li>
   <li><a href="../../v0.7.0/index.html">v0.7.0</a></li>
   <li><a href="../../v0.6.0/index.html">v0.6.0</a></li>
   <li><a href="../../v0.0.5/index.html">v0.0.5</a></li>
   <li><a href="../../v0.0.4/index.html">v0.0.4</a></li>
   <li><a href="../../v0.0.3/index.html">v0.0.3</a></li>
   <li><a href="../../v0.0.2/index.html">v0.0.2</a></li>
   <li><a href="../../v0.0.1/index.html">v0.0.1</a></li>
</ul></li>
<!-- end_releases -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.roche.com/NEST/teal">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Teal Desiderata</h1>
                        <h4 class="author">Adrian Waddell</h4>
            
            <h4 class="date">2019-10-04</h4>
      
      
      <div class="hidden name"><code>teal_desiderata.Rmd</code></div>

    </div>

    
    
<p>This is a list of possible directions to continue the teal development.</p>
<div id="abstract-fitereddata-class" class="section level1">
<h1 class="hasAnchor">
<a href="#abstract-fitereddata-class" class="anchor"></a>Abstract FiteredData Class</h1>
<p>Currently <code>teal</code> implements a filtering model that is useful to for clinical trials data only as it requires an <code>ASL</code> dataset and that every dataset has the <code>USUBJID</code> and <code>STUDYID</code> variables. Please read the <code>10_teal_design_and_implementation</code> vignette for more details.</p>
<p>The required work is to make the <code>FilteredData</code> class abstract and create concrete classes for particular data models:</p>
<p><img src="images/design_FilteredData.png" width="476"></p>
<p>Note that this also requires to turn the filter panel (which is shown on the left hand side in teal app) into a shiny module that dispatches based on the concrete class inheriring from <code>FilteredData</code>.</p>
</div>
<div id="modularize-teal" class="section level1">
<h1 class="hasAnchor">
<a href="#modularize-teal" class="anchor"></a>Modularize Teal</h1>
<p>Currently teal needs to be a toplevel shiny app, i.e.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(teal)

x &lt;-<span class="st"> </span>teal<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/teal/man/init.html">init</a></span>(...)

<span class="kw">shinyApp</span>(x<span class="op">$</span>ui, x<span class="op">$</span>server)</code></pre></div>
<p>It would be great if we could modularize teal itself so that it can be integrated (possibly multiple times) into another enclosing shiny app. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(teal)

teal_instance &lt;-<span class="st"> </span>teal<span class="op">::</span><span class="kw">init_as_module</span>(...)

ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(
  <span class="kw">titlePanel</span>(<span class="st">"Giant App That Uses teal only in one Frame"</span>),

  <span class="kw">sidebarLayout</span>(
    <span class="kw">sidebarPanel</span>(<span class="st">"sidebar panel"</span>),
    <span class="kw">mainPanel</span>(
      <span class="st">"main panel"</span>,
      teal_instance<span class="op">$</span><span class="kw">ui</span>(<span class="dt">id =</span> <span class="st">"teal_1"</span>)
    )
  )
)

server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {
  <span class="co"># own code and then</span>
  <span class="kw">callModule</span>(<span class="dt">module =</span> teal_instance<span class="op">$</span>server, <span class="dt">id =</span> <span class="st">"teal_1"</span>)
}

<span class="kw">shinyApp</span>(ui, server)</code></pre></div>
<p>This way we could use multiple instances of teal with possibly different data and data models in one overarching app.</p>
</div>
<div id="save-and-share-state" class="section level1">
<h1 class="hasAnchor">
<a href="#save-and-share-state" class="anchor"></a>Save and Share State</h1>
<p>It would be nice to implement a “Share” or a “Bookmark” button that saves the current state of a teal app (which data was loaded, filters set, encoding settings, etc…) so that an analysis state can be shared.</p>
</div>
<div id="improve-variable-browser" class="section level1">
<h1 class="hasAnchor">
<a href="#improve-variable-browser" class="anchor"></a>Improve Variable Browser</h1>
<p>Currently the <code>tm_variable_browser</code> is very basic. The univariate visualization of the data can be improved (and abtracted). For example,</p>
<ul>
<li>Make a better summary of factor variables with many factor levels</li>
<li>Provide multiple selection for bivariate plots</li>
</ul>
</div>
<div id="improve-the-data-table-view" class="section level1">
<h1 class="hasAnchor">
<a href="#improve-the-data-table-view" class="anchor"></a>Improve the Data Table View</h1>
<p>The <code>tm_data_table</code> module could also need some more basic raw data interaction features. Right now we only allow for frequency counts of unique rows.</p>
<ul>
<li>The dataset selection needs some <code>CSS</code> styling</li>
</ul>
</div>
<div id="split-view" class="section level1">
<h1 class="hasAnchor">
<a href="#split-view" class="anchor"></a>Split View</h1>
<p>Currently only one teal module can be shown at any given time (without manually chaning the <code>ui</code> object that is returned by <code><a href="../reference/init.html">teal::init</a></code>). Since it is not possible to start the same shiny app twice it would hence be nice to find a good solution to have two outputs side-by side (with their encoding panels).</p>
</div>
<div id="framework-for-logging-and-analysis-guidance" class="section level1">
<h1 class="hasAnchor">
<a href="#framework-for-logging-and-analysis-guidance" class="anchor"></a>Framework For Logging and Analysis Guidance</h1>
<p>If we were to share an interactive analysis environment with a health authority it would be good to guide (and restrict) them with the analysis that they can make with that app. Although this can be currently done there is no nice framework to do this.</p>
<p>Also it would be good to have a concise logging that shows what which stakeholder has analyzed (e.g. if a teal app is shared with affiliates).</p>
</div>
<div id="class-system-for-teal-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#class-system-for-teal-modules" class="anchor"></a>Class System For Teal Modules</h1>
<p>Right now it is not possible to extend an existing teal module without modifying that module (e.g. by adding arguments). For example for the <code>tm_scatterplot</code> molude one might be interested to add a regression line or a loess smother on top of the points. It would be great to design a teal module system that would allow something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_new_module &lt;-<span class="st"> </span><span class="kw">Class</span>(<span class="dt">expands =</span> <span class="st">"tm_scatterplot"</span>,
                       <span class="dt">ui =</span> {
                         x &lt;-<span class="st"> </span><span class="kw">parent</span>()
                         <span class="kw">tagList</span>(
                           <span class="kw">h1</span>(<span class="st">"new stuff"</span>),
                           x
                         )
                       },
                       <span class="dt">server =</span> {
                         s &lt;-<span class="st"> </span><span class="kw">parent</span>()
                         <span class="co"># modify parent reactive expressions</span>
                         output<span class="op">$</span>plot &lt;-<span class="st"> </span><span class="kw">reactive</span>({
                           gg &lt;-<span class="st"> </span>s<span class="op">$</span>plot

                           gg <span class="op">+</span><span class="st"> </span><span class="kw">geom_smoot</span>()
                         })
                       }
                       )</code></pre></div>
</div>
<div id="module-interdependencies" class="section level1">
<h1 class="hasAnchor">
<a href="#module-interdependencies" class="anchor"></a>Module Interdependencies</h1>
<p>Currently all implemented teal modules are completely independent. However it would be nice to have global states, e.g. the <code>ASL</code> variable with the study arm information. This probably won’t require huge changes (modules need to optionally accept reactive values as arguments), but I have not done it so far.</p>
</div>
<div id="code-reproducibility" class="section level1">
<h1 class="hasAnchor">
<a href="#code-reproducibility" class="anchor"></a>Code Reproducibility</h1>
<p>We have now three prposed ways to do get reprodicuble code:</p>
<ol style="list-style-type: decimal">
<li><p>Doug’s way with parsing all the involved code and turn reative endpoints to ordinary function call (still need to work on that pull-request). This is a general solution that does not require the module developper to do anything.</p></li>
<li><p>Capturing analysis code and the substitute and stack the code manually to match the analysis. It would be nice to implement <code>nameExpression(name, expression)</code> which captures analysis code in a transparent way.</p></li>
<li><p>Delegate the analysis to essentially a function call and have the encoding panel only affect the arguments. E.g.</p></li>
</ol>
<p>The important part here is that there is a clean distinction what teal does and what the teal module developer has to do. For example, for the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(survival)

## Attributes to the datasets that are passed to the init data argument
ASL &lt;-<span class="st"> </span><span class="kw">read_bce</span>(<span class="st">'/opt/BIOSTAT/qa/i9999/libraries/asl.sas7bdat'</span>)
ATE &lt;-<span class="st"> </span><span class="kw">read_bce</span>(<span class="st">'/opt/BIOSTAT/qa/i9999/libraries/ate.sas7bdat'</span>)

## Filter Panel
ASL_f &lt;-<span class="st"> </span>ASL <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(SEX <span class="op">==</span><span class="st"> 'F'</span>)
ATE_filtered &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/merge.html">merge</a></span>(ASL_f, ATE, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"USUBJID"</span>, <span class="st">"STUDYID"</span>))


## Teal Module Developer Resposibility (Encoding &amp; Ouptput)
ANL &lt;-<span class="st"> </span>ATE_filtered <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(ITTFL <span class="op">==</span><span class="st"> 'Y'</span>, PARAMCD <span class="op">==</span><span class="st"> 'OS'</span>)

p &lt;-<span class="st"> </span><span class="kw">p_km</span>(
  <span class="dt">formula =</span> <span class="kw"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span>(AVAL, <span class="op">!</span>CNSR) <span class="op">~</span><span class="st"> </span>ARM <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/survival/man/strata.html">strata</a></span>(ECOG, BAGE),
  <span class="dt">data =</span> ANL
)</code></pre></div>
<p>Also note that the reproducible code should not depend on teal.</p>
</div>
<div id="filter-labels-and-fiter-states" class="section level1">
<h1 class="hasAnchor">
<a href="#filter-labels-and-fiter-states" class="anchor"></a>Filter Labels and Fiter States</h1>
<p>For clinical trials it is custom in Roche/Genetech to define labels that relate to certain subsets of the patients. It would be good to extend the filter panel (right hand side, not in the encoding panel) to facility filter labels, standard filter configuratrions and reset to standard filter configurations.</p>
<p>Note that a standard filter configuration is supported when initializing the teal app, however it’s not possible to reset to that standard filter state.</p>
</div>
<div id="data-extraction-widget" class="section level1">
<h1 class="hasAnchor">
<a href="#data-extraction-widget" class="anchor"></a>Data Extraction Widget</h1>
<p>As clinical trials data is often in a vertical form is is often neccessary to do the following operartion in order to get to a particular measure for each patient:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">RAW_DATA <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(PARAM <span class="op">==</span><span class="st"> "aaa"</span>, ZA <span class="op">==</span><span class="st"> "bbb"</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(AVAL)</code></pre></div>
<p>That is, the filtering is necessary to get to one value of interest per patient and the select is necessary to specify the column where the values are stored. It would be great to create an abtracted filter/select shiny module that provides an intuitive user interface for this. I can extend on this problem if necessary.</p>
</div>
<div id="more-standard-general-teal-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#more-standard-general-teal-modules" class="anchor"></a>More Standard General Teal Modules</h1>
<p>Currently teal comes with the following standard modules:</p>
<ul>
<li>variable browser</li>
<li>data table viewer</li>
<li>scatterplot</li>
<li>crosstable</li>
<li>(I started the scatterplot matrix)</li>
</ul>
<p>It would be nice to extend the catalogue of very general modules. Specialized modules (kaplan meier plot, time to event analysis, etc.) live in other packages such as <code>teal.modules.clinical</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#abstract-fitereddata-class">Abstract FiteredData Class</a></li>
      <li><a href="#modularize-teal">Modularize Teal</a></li>
      <li><a href="#save-and-share-state">Save and Share State</a></li>
      <li><a href="#improve-variable-browser">Improve Variable Browser</a></li>
      <li><a href="#improve-the-data-table-view">Improve the Data Table View</a></li>
      <li><a href="#split-view">Split View</a></li>
      <li><a href="#framework-for-logging-and-analysis-guidance">Framework For Logging and Analysis Guidance</a></li>
      <li><a href="#class-system-for-teal-modules">Class System For Teal Modules</a></li>
      <li><a href="#module-interdependencies">Module Interdependencies</a></li>
      <li><a href="#code-reproducibility">Code Reproducibility</a></li>
      <li><a href="#filter-labels-and-fiter-states">Filter Labels and Fiter States</a></li>
      <li><a href="#data-extraction-widget">Data Extraction Widget</a></li>
      <li><a href="#more-standard-general-teal-modules">More Standard General Teal Modules</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by NEST, Adrian Waddell, Pawel Rucki, Dawid Kaledkowski, Sebastian Wolf, Maximilian Mordig, Bartosz Baranowski, Roche.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
